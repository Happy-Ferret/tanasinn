
CPP=@CPP@
ASCIIDOC=@ASCIIDOC@
OPEN=@TANASINN_OPEN@

ifdef $(CPP)
ifdef $(ASCIIDOC)
all: usermanual-ja.html usermanual.html
else
all:
endif
else
all:
endif

Makefile: Makefile.in
	cd .. && ./configure

usermanual.html: usermanual.txt Makefile
	if [ -a ( -n "$(ASCIIDOC)" ) ( -n "$(CPP)" ) ]; \
	then \
		$(RM) $@ && cat $< \
		| sed -e 's/#\/\//#\/#\//g;s/#\/\*/#\/#*/g' \
		| $(CPP) -D__EN__ - \
		| sed -e 's/#\/#\//\/\//g;s/#\/#\*/\/*/g' \
		| sed -e 's/^#.*//' \
		| $(ASCIIDOC) - > $@; \
	fi

usermanual-ja.html: usermanual.txt Makefile
	if [ -a ( -n "$(ASCIIDOC)" ) ( -n "$(CPP)" ) ]; \
	then \
		$(RM) $@ && cat $< \
		| sed -e 's/#\/\//#\/#\//g;s/#\/\*/#\/#*/g' \
		| $(CPP) -D__JP__ - \
		| sed -e 's/#\/#\//\/\//g;s/#\/#\*/\/*/g' \
		| sed -e 's/^#.*//' \
		| $(ASCIIDOC) - > $@; \
	fi
